<ion-view view-title="Story">
  <ion-pane>
      
<!--      Image displayed behind the tab contents-->
    <ion-content class="has-header has-tabs-top">
      <img ng-src="{{story.images[0]}}" width="100%"/>
    </ion-content>

      <ion-tabs class="tabs-balanced tabs-icon-top" delegate-handle="story-tabs-delegate">

        <ion-spinner ng-if="!story"></ion-spinner>


        <ion-tab title="Description" icon="ion-android-list" ng-if="story.description">
          <overscroll-pane>
            <div class="display-card">

              <h3 class="title">{{story.name}}</h3>
              <p ng-repeat="paragraph in story.description">
                {{paragraph}}<br />
              </p>
            </div>
          </overscroll-pane>
        </ion-tab>

        <ion-tab title="Images" icon="ion-android-image" ng-if="story.images">
          <overscroll-pane>
            <div class="display-card">

              <div class="row" ng-repeat="image in story.images" ng-if="$index % 2 === 0">
                <div class="col col-50" ng-if="$index < story.images.length">
                    <img ng-src="{{story.images[$index]}}" width="100%"
                    ng-click="display(story.images[$index])"/>
                </div>
                <div class="col col-50" ng-if="$index + 1 < story.images.length">
                    <img ng-src="{{story.images[$index + 1]}}" width="100%"
                    ng-click="display(story.images[$index +1])"/>
                </div>
              </div>
            </div>
          </overscroll-pane>
        </ion-tab>

        <ion-tab title="Audio" icon="ion-android-volume-up" ng-if="story.audio">
          <overscroll-pane>
            <div class="display-card">
                <ion-content>
                    <button class="button button-assertive" ng-click="playTrack(0)">Play Land of Confusion - Genesis</button>
                    <button class="button button-assertive" ng-click="playTrack(1)">Play Tonight, Tonight - Genesis</button>
                    <ion-audio-track track="dynamicTrack" toggle-playback="togglePlayback">
                        <div class="card">
                            <div class="item">
                                <h2>{{dynamicTrack.title}}</h2>

                                <p>{{dynamicTrack.artist}}</p>
                                <ion-audio-controls>
                                    <a class="button button-icon icon" ion-audio-play></a>
                                    <ion-spinner icon="ios" style="position: relative; top: 8px; left: 4px"></ion-spinner>
                                </ion-audio-controls>
                            </div>
                            <div class="item item-divider">
                                <ion-audio-progress-bar track="dynamicTrack" display-time></ion-audio-progress-bar>
                            </div>
                        </div>
                    </ion-audio-track>
                </ion-content>
            </div>
          </overscroll-pane>
        </ion-tab>

        <ion-tab title="Map" icon="ion-android-pin" ng-if="story.location">
          <overscroll-pane>
            <div class="display-card">

                  <marker-map places="places"
                              center="story.location" 
                              zoom="mapInfo.zoom"
                              info-windows="false"
                              center-on-click="true">
                  </marker-map>
              </div>
            </overscroll-pane>
        </ion-tab>

      </ion-tabs>

    </ion-pane>
</ion-view>
